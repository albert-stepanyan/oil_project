# Выбор локации для скважины

## Описание проекта
Допустим, вы работаете в добывающей компании «ГлавРосГосНефть». Нужно решить, где бурить новую скважину.

Вам предоставлены пробы нефти в трёх регионах: в каждом 10 000 месторождений, где измерили качество нефти и объём её запасов. Постройте модель машинного обучения, которая поможет определить регион, где добыча принесёт наибольшую прибыль. Проанализируйте возможную прибыль и риски техникой *Bootstrap.*

Шаги для выбора локации:

- В избранном регионе ищут месторождения, для каждого определяют значения признаков;
- Строят модель и оценивают объём запасов;
- Выбирают месторождения с самым высокими оценками значений. Количество месторождений зависит от бюджета компании и стоимости разработки одной скважины;
- Прибыль равна суммарной прибыли отобранных месторождений.

## План работы

1.	Загрузим и подготовим данные. Поясним порядок действий.
2.	Обучим и проверим модель для каждого региона:  
    2.1. Разобъем данные на обучающую и валидационную выборки в соотношении 75:25.  
    2.2. Обучим модель и сделаем предсказания на валидационной выборке.  
    2.3. Сохраним предсказания и правильные ответы на валидационной выборке.  
    2.4. Напечатаем на экране средний запас предсказанного сырья и RMSE модели.  
    2.5. Проанализируем результаты.  
3.	Подготовимся к расчёту прибыли:  
    3.1. Все ключевые значения для расчётов сохраним в отдельных переменных.  
    3.2. Рассчитаем достаточный объём сырья для безубыточной разработки новой скважины. Сравним полученный объём сырья со средним запасом в каждом регионе.   
    3.3. Напишем выводы по этапу подготовки расчёта прибыли.  
4.	Напишем функцию для расчёта прибыли по выбранным скважинам и предсказаниям модели:  
    4.1. Выберем скважины с максимальными значениями предсказаний.   
    4.2. Просуммируем целевое значение объёма сырья, соответствующее этим предсказаниям.  
    4.3. Рассчитаем прибыль для полученного объёма сырья.  
5.	Посчитаем риски и прибыль для каждого региона:  
    5.1. Применим технику Bootstrap с 1000 выборок, чтобы найти распределение прибыли.  
    5.2. Найдем среднюю прибыль, 95%-й доверительный интервал и риск убытков. Убыток — это отрицательная прибыль.  
    5.3. Напишем выводы: предложим регион для разработки скважин и обоснуем выбор.

## Описание данных

- `id` — уникальный идентификатор скважины
- `f0`, `f1`, `f2` — три признака точек (неважно, что они означают, но сами признаки значимы)
- `product` — объём запасов в скважине (тыс. баррелей)

***Данные геологоразведки трёх регионов находятся в файлах:***  
- `/datasets/geo_data_0.csv`  
- `/datasets/geo_data_1.csv`
- `/datasets/geo_data_2.csv`

## Условия задачи

- Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые)   
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки  
- Бюджет на разработку скважин в регионе — 10 млрд рублей  
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью 

***Данные синтетические: детали контрактов и характеристики месторождений не разглашаются.***

## Выводы:

- Загрузили и изучили данные о пробах нефти в трёх регионах
- Пропуски и дубликаты отсутствуют
- Исследование показало наличие парных дубликатов по столбцу `id` в каждой таблице. Остальные параметры различны. Принял решение разделить эти данные переименовав `id` добавив `_1` и `_2` в конце
- Визуализировали и изучили диаграммы размаха. Обнаружили выбросы находящиеся за границей нижнего и верхнего кварти́ля. Создали функцию для их удаления. Посчитали предварительно процент удаляемых данных выбросов. Он не превышал 0.8%
- Визуализация матрицы диаграммы размаха подтвердила, что выбросы удалены
- Провели анализх данных изучив диаграммы рассеяния и тепловую карту корреляции. Отмечено, что для 1-го региона признак `f2` очень сильно коррелирует с целевым признаком. Из-за слабой корреляции остальных признаков принято решение для повышения качества работы моделей машинного обучения воспользоваться способом создания новых признаков
- Новые признаки созданы и добавлены. Провели анализх с дополненными данными, построив диаграммы рассеяния и тепловую карту корреляции
- Написали функцию для обучения модели линейной регрессии, предварительно разбив данные на обучающую и валидационную выборку в соотношении 75:25 и приведя признаки к единому масштабу 
- Обучили модель и сделали предсказания на валидационной выборке, сохранив предсказания и правильные ответы на валидационной выборке
- Вывели на экран средний запас предсказанного сырья и RMSE модели каждого региона
- Рассчитали достаточный объём сырья для безубыточной разработки новой скважины. Сравнили полученный объём сырья со средним запасом в каждом регионе
- Написали функцию для расчёта прибыли по выбранным скважинам и предсказаниям модели и выбрали скважины с максимальными значениями предсказаний
- Построили диаграммы размаха по каждому региону. Увидели преимущественные регионы.
- Рассчитали прибыль для полученного объёма сырья
- Посчитали риски и прибыль для каждого региона. Вычислили среднюю выручку, 95%-й доверительный интервал и риск убытков

***Вывод по предлагаемому региону:***

***По результатам проведенного анализа сделан следующий вывод,  что прибыль в 3-ем регионе по данным geo_data_2 выше остальных и риск убытов минимален. И на основе анализа, этот регион предлагается для разработки скважин.***
